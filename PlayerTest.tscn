[gd_scene load_steps=20 format=2]

[ext_resource path="res://Nodes/Player.tscn" type="PackedScene" id=1]
[ext_resource path="res://crack.png" type="Texture" id=2]
[ext_resource path="res://noise.jpg" type="Texture" id=3]
[ext_resource path="res://terrain_textures.png" type="TextureArray" id=4]
[ext_resource path="res://rgb_noise.png" type="Texture" id=5]
[ext_resource path="res://Dyamic_grid_shader.shader" type="Shader" id=6]
[ext_resource path="res://Nodes/Enemy.tscn" type="PackedScene" id=7]
[ext_resource path="res://sprite/bg.png" type="Texture" id=8]
[ext_resource path="res://sprite/core.png" type="Texture" id=9]
[ext_resource path="res://Nodes/TeslaSpawner.tscn" type="PackedScene" id=10]
[ext_resource path="res://core.gd" type="Script" id=11]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

var pickupableitem_object := load(\"res://Nodes/PickupableItem.tscn\")

var spawn_pickupable_time = 20
var spawn_pickupable_timer = 0

var min_spawn_pickupableitem_radius = 80
var max_spawn_pickupableitem_radius = 300

func _ready() -> void:
	randomize()
	globals.center = $Center
	globals.map = $DynamicGridMap


	


func _process(delta):
	if spawn_pickupable_timer < spawn_pickupable_time:
		spawn_pickupable_timer += delta
	else:
		spawn_pickupable_timer = 0
		var spawn_radius = rand_range(min_spawn_pickupableitem_radius,max_spawn_pickupableitem_radius)
		var spawn_angle = rand_range( 0, TAU )
		var pickupable_item = pickupableitem_object.instance()
		add_child(pickupable_item)
		pickupable_item.global_position = globals.center.global_position + Vector2(spawn_radius, 0).rotated(spawn_angle)
	pass


func _on_endgame_timer_timeout():
	var explo = preload(\"res://Nodes/big_explosion.tscn\").instance()
	add_child(explo)
	explo.rotation=rand_range(0,2*PI)
	explo.scale*=rand_range(0.5,1.5)
	explo.global_position=Vector2(1024,1024)+Vector2(rand_range(-300,300),rand_range(-300,300))
	pass # Replace with function body.
"

[sub_resource type="ShaderMaterial" id=2]
shader = ExtResource( 6 )
shader_param/global_transform = null
shader_param/cutoff = 0.99
shader_param/random_blur = 0.001
shader_param/blur_amount = 2.5
shader_param/dirt_tile_mul = 0.489
shader_param/crack_tile_mul = 2.198
shader_param/noise_tile_mul = -0.032
shader_param/random_noise_mul = 25.0
shader_param/show_hidden = 0.0
shader_param/crack_tiled = ExtResource( 2 )
shader_param/noise_tiled = ExtResource( 3 )
shader_param/random_noise = ExtResource( 5 )
shader_param/terrain_texture_mix = ExtResource( 4 )

[sub_resource type="MaterialData" id=3]

[sub_resource type="CanvasItemMaterial" id=4]
blend_mode = 1

[sub_resource type="CanvasItemMaterial" id=5]
blend_mode = 1

[sub_resource type="CanvasItemMaterial" id=6]
blend_mode = 1

[sub_resource type="Animation" id=7]
length = 10.0
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath("core:rotation_degrees")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 5.2, 10 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ 0.0, 360.0, 720.0 ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("core2:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 5.2, 10 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ 360.0, 0.0, -360.0 ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("core3:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0, 1, 2, 3.01577, 4.02452, 5.43576, 5.99014, 6.98519, 7.75595, 8.58448, 9.25533, 9.7 ),
"transitions": PoolRealArray( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 0.984314 ), Color( 1, 1, 1, 0.603922 ), Color( 1, 1, 1, 0.984314 ), Color( 1, 1, 1, 0.603922 ), Color( 1, 1, 1, 0.984314 ), Color( 1, 1, 1, 0.603922 ), Color( 1, 1, 1, 0.984314 ), Color( 1, 1, 1, 0.603922 ), Color( 1, 1, 1, 0.984314 ), Color( 1, 1, 1, 0.603922 ), Color( 1, 1, 1, 0.984314 ), Color( 1, 1, 1, 0.603922 ) ]
}

[sub_resource type="CircleShape2D" id=8]
radius = 92.2693

[node name="Node2D" type="Node2D"]
script = SubResource( 1 )

[node name="bg" type="Sprite" parent="."]
position = Vector2( 1036.93, 1063.57 )
scale = Vector2( 1.215, 1.31 )
texture = ExtResource( 8 )

[node name="bg2" type="Sprite" parent="."]
position = Vector2( 1036.93, 1063.57 )
scale = Vector2( 1.215, 1.31 )
texture = ExtResource( 8 )

[node name="DynamicGridMap" type="DynamicGridMap" parent="."]
material = SubResource( 2 )
material_data = SubResource( 3 )
texture_path = "res://full.png"

[node name="Player1" parent="." instance=ExtResource( 1 )]
position = Vector2( 622.17, 591.279 )
color = Color( 1, 1, 1, 1 )

[node name="Player2" parent="." instance=ExtResource( 1 )]
position = Vector2( 1634.86, 479.692 )
player = 1
color = Color( 0.788235, 0.423529, 0.458824, 1 )

[node name="Player3" parent="." instance=ExtResource( 1 )]
position = Vector2( 528.639, 1336.73 )
player = 2
color = Color( 0.419608, 1, 0.301961, 1 )

[node name="Player4" parent="." instance=ExtResource( 1 )]
position = Vector2( 1566.9, 1161.17 )
player = 3
color = Color( 0.839216, 0.266667, 1, 1 )

[node name="Center" type="Position2D" parent="."]
position = Vector2( 1025.31, 1042.35 )

[node name="Enemy" parent="Center" instance=ExtResource( 7 )]
position = Vector2( -660.38, -449.539 )
spawn_distance = 800.0
orbit_distance = 600.0

[node name="PickupableItem" type="Node2D" parent="Center"]
position = Vector2( -1025.31, -1042.35 )
script = ExtResource( 9 )

[node name="TeslaSpawner" parent="Center" instance=ExtResource( 10 )]

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2( 1024, 1038 )
current = true

[node name="core" type="Area2D" parent="."]
self_modulate = Color( 1, 1, 1, 0 )
position = Vector2( 1015.24, 1046.43 )
scale = Vector2( 0.5, 0.5 )
script = ExtResource( 11 )

[node name="core3" type="Sprite" parent="core"]
modulate = Color( 1, 1, 1, 0.666984 )
material = SubResource( 4 )
scale = Vector2( 1.241, 1.266 )
texture = ExtResource( 9 )

[node name="core2" type="Sprite" parent="core"]
modulate = Color( 1, 0.0705882, 0, 1 )
material = SubResource( 5 )
rotation = 4.87457
scale = Vector2( 0.807, 0.754 )
texture = ExtResource( 9 )

[node name="core" type="Sprite" parent="core"]
self_modulate = Color( 4.62, 0, 9.25, 0.5 )
material = SubResource( 6 )
rotation = 1.40862
scale = Vector2( 0.786, 0.851 )
texture = ExtResource( 9 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="core"]
autoplay = "New Anim"
"anims/New Anim" = SubResource( 7 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="core"]
visible = false
shape = SubResource( 8 )

[node name="endgame_timer" type="Timer" parent="."]
wait_time = 0.014

[connection signal="area_entered" from="core" to="core" method="_on_core_area_entered"]
[connection signal="timeout" from="endgame_timer" to="." method="_on_endgame_timer_timeout"]
